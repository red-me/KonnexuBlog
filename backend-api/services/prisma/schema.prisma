generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Post {
  id          Int            @id @default(autoincrement())
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  title       String         @default("") @db.VarChar(255)
  description String         @default("") @db.VarChar(5000)
  type        String         @db.VarChar(25)
  content     Json?
  published   Boolean        @default(false)
  authorId    Int
  deleted     Boolean        @default(false)
  activities  Activity[]
  replies     Reply[]
  author      User           @relation(fields: [authorId], references: [id])
  categories  PostCategory[] @relation("PostToPostCategory")
  tags        Tag[]          @relation("PostToTag")

  @@index([authorId], map: "Post_authorId_fkey")
}

model Reply {
  id        Int      @id @default(autoincrement())
  content   String   @default("") @db.VarChar(5000)
  meta      Json?
  post      Post     @relation(fields: [postId], references: [id])
  postId    Int
  author    User     @relation(fields: [authorId], references: [id])
  authorId  Int
  published Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Activity {
  id        Int      @id @default(autoincrement())
  type      String
  postId    Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  post      Post?    @relation(fields: [postId], references: [id])

  @@index([postId], map: "Activity_postId_fkey")
}

model Tag {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  posts     Post[]   @relation("PostToTag")
}

model PostCategory {
  id          Int      @id @default(autoincrement())
  title       String
  description String?
  slug        String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  appId       Int
  app         App      @relation(fields: [appId], references: [id])
  posts       Post[]   @relation("PostToPostCategory")

  @@index([appId], map: "PostCategory_appId_fkey")
}

model Country {
  id        String     @id @default(cuid())
  iso       String?
  name      String?
  active    Boolean    @default(true)
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  provinces Province[]
}

model Province {
  id        String   @id @default(cuid())
  name      String?
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  countryId String?
  country   Country? @relation(fields: [countryId], references: [id])

  @@index([countryId], map: "Province_countryId_fkey")
}

model User {
  id                Int              @id @default(autoincrement())
  email             String           @unique
  password          String
  name              String           @unique @default(cuid())
  active            Boolean
  sessionToken      String           @default("")
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  lastActivity      DateTime         @default(now())
  lastIPAddress     String           @default("")
  userGroupId       Int?
  privacySettingsId Int?
  posts             Post[]
  replies           Reply[]
  profile           Profile?
  privacySettings   PrivacySettings? @relation(fields: [privacySettingsId], references: [id])
  userGroup         UserGroup?       @relation(fields: [userGroupId], references: [id])

  @@index([privacySettingsId], map: "User_privacySettingsId_fkey")
  @@index([userGroupId], map: "User_userGroupId_fkey")
}

model Profile {
  id              Int      @id @default(autoincrement())
  firstName       String?
  lastName        String?
  avatar          String?
  userId          Int      @unique
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  city            String?  @default("")
  displayName     String   @default("")
  dob             String?  @default("")
  gender          String?  @default("")
  location        String?  @default("")
  primaryLanguage String?  @default("")
  spamCount       Int?     @default(0)
  tz              String?  @default("")
  zip             String?  @default("")
  user            User     @relation(fields: [userId], references: [id])
}

model PrivacySettings {
  id                                    Int      @id @default(autoincrement())
  userId                                Int      @unique
  whoCanViewProfilePage                 String?  @default("")
  whoCanViewProfilePageInfoTab          String?  @default("")
  whoCanViewBasicInfo                   String?  @default("")
  whoCanViewLocation                    String?  @default("")
  whoCanViewProfilePageActivities       String?  @default("")
  whoCanPostOnWall                      String?  @default("")
  whoCanViewFriendsList                 String?  @default("")
  whoCanSendFriendRequest               String?  @default("")
  whoCanSendMessage                     String?  @default("")
  whoCanViewProfilePagePhotos           String?  @default("")
  whoCanSendPokes                       String?  @default("")
  whoCanDisplayRSSSubscriberCount       String?  @default("")
  whoCanSubscribeToRSS                  String?  @default("")
  whoCanViewProfilePageRecentlyViewedBy String?  @default("")
  whoCanTagMe                           String?  @default("")
  createdAt                             DateTime @default(now())
  updatedAt                             DateTime @updatedAt
  User                                  User[]
}

model UserGroup {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  isDefault Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  users     User[]
}

model File {
  id            String   @id @default(uuid())
  file_path     String   @db.VarChar(1000)
  file_mimetype String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model App {
  id             Int            @id @default(autoincrement())
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  name           String         @unique
  url            String         @db.VarChar(1000)
  scope          String         @db.VarChar(255)
  modules        Json?
  settings       Json?
  enabled        Boolean        @default(true)
  postCategories PostCategory[]
}

model SiteSetting {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  themeId   String?  @unique
  theme     Theme?   @relation(fields: [themeId], references: [id])
}

model Theme {
  id                      String       @id @default(cuid())
  createdAt               DateTime     @default(now())
  updatedAt               DateTime     @updatedAt
  name                    String       @unique
  description             String       @default("") @db.VarChar(5000)
  featured                Boolean      @default(false)
  data                    Json?
  deleted                 Boolean      @default(false)
  brandBackgroundPhotoUrl String       @default("")
  brandLogoUrl            String       @default("")
  SiteSetting             SiteSetting?
}

model Menu {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  name        String   @unique
  description String   @default("") @db.VarChar(5000)
  data        Json?
  deleted     Boolean  @default(false)
}
